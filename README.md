# SafeWorkspace

Smart Office Space Monitoring System

## Description
SafeWorkspace is an intelligent monitoring system for office environments, using a network of sensors to detect smoke, gas, temperature, and humidity in real time. The system identifies environmental changes and, based on detected dangers (e.g., fire, gas leaks, temperature spikes), it automatically alerts the user and contacts the appropriate services without user intervention.

## Installation Requirements

### Project Cloning
#### 1. Clonarea repository-ului

##### Option 1 – Using HTTPS:
```bash
git clone 
```
### Angular
#### 1. Install Node.js

- Download from: [https://nodejs.org/](https://nodejs.org/)
- Install the LTS (Long-Term Support) version.
- Verify installation:

    ```bash
    node -v
    npm -v
    ```
- Required: node >= 20.x, npm >= 10.x
---
#### 2. Install Angular CLI
    ```bash
    npm install -g @angular/cli
    ```
- Check installation:
    
    ```bash
    ng version
    ```
- Recommended Angular version: >= 15.x
---

#### 3. Run Angular App
    ```bash
    cd .\AngularProject\
    ```
- Run the app:
    
    ```bash
    ng serve
    ```
- You can also run the app via your IDE.

- Then open: [http://localhost:4200](http://localhost:4200)
---
### Spring Boot Setup

#### 1. Java JDK:

  - Download:  [https://www.oracle.com/java/technologies/javase/jdk21-archive-downloads.html](https://www.oracle.com/java/technologies/javase/jdk21-archive-downloads.html)

  - Check installation:

    ```bash
    java -version
    ```
  - Recommended Java version **21**.
---
#### 2. Apache Maven:

  - If using IntelliJ IDEA or VS Code, Maven is usually built-in.
  
  - If using CLI, download: https://maven.apache.org/download.cgi

  - Check installation:
    ```bash
    mvn -v
    ```
---
#### 3. Run Spring Boot
  1. Open the Backend folder in your IDE.
  2. Locate SpringProjectApplication.java
  3. Click ▶️ Run or right-click > Run
  4. App runs by default on port 8080

  > Make sure all environment variables are properly set before running. (vezi secțiunea `Variabile de mediu`)

### Create Firebase Project

Aplicația folosește **Cloud Firestore** ca bază de date principală pentru stocarea informațiilor.


#### 1. Creare proiect Firebase

1. Go to:  
   [https://console.firebase.google.com](https://console.firebase.google.com)
2. Click "Add project"

---

#### 2. Enable Firestore

1. Go to Build > Firestore Database > Create Database
2. Choose Production Mode
3. Select a nearby region

---

#### 3. Create Collections

Create these collections:

- `users`
- `rooms`
- `sensors`
- `alerts`
- `custom_alerts`

Documents will be auto-generated by the app.

---

#### 4. Generate Firebase Admin Key

1. Go to Project Settings > Service Accounts
2. Click Generate new private key
3. Save it as firebase-key.json

---

#### 5. Set Environment Variable for Key Path


##### Windows:
```cmd
set FIREBASE_CONFIG_PATH=C:\firebase\firebase-key.json
```
##### Linux/MacOS:
```cmd
export FIREBASE_CONFIG_PATH=/home/user/firebase/firebase-key.json
```
Update FirebaseInitializer.java to use this environment variable.

---
### Google OAuth2


#### 1. Create a Google Cloud Project

1. Go to: [https://console.developers.google.com](https://console.developers.google.com)

---

#### 2. Activare API

1. Enable Google Identity Services
---

#### 3. Create OAuth2 Client

1. Go to Credentials > Create Credentials > OAuth Client ID
2. Choose: Web Application
3. Selectează tipul aplicației: **Web application**
4. Add Redirect URIs:
   - **Authorized redirect URIs**:
       - `http://localhost:4200` 
       - `http://localhost:8080/login/oauth2/code/google`
       - `http://localhost:8080/auth/google`

5. After that you will get the:
   - `Client ID`
   - `Client Secret`

---

### Twilio Integration (SMS/Calls)


---

#### 1. Create Twilio Account

1. Go to: [https://www.twilio.com/try-twilio](https://www.twilio.com/try-twilio)
2. Register and verify your phone number
- Warning: if you have a non-premium account, the SMS/Calls will be send only to the verified numbers. 
---

#### 2. Retrieve Twilio Credentials

1. Go to Console Dashboard abd copy:
  - **Account SID**
  - **Auth Token**
  - **Twilio Number**

---

#### 3. Backend Usage

Twilio is used to send:

- SMS alerts
- Automated voice calls with alert messages

> Handled in the backend service TwilioService.

---

### Hardware Setup

Used boards:

- **Arduino Uno R4 WiFi**
- **ESP32 DevKit V1** (x2)

Used sensors:
- `DHT22` – temperature and humidity
- `MQ2` – smoke/gas
- `MQ5` – methane, LPG, alcohol

---

#### 1. Install Arduino IDE

1. Go to:  
   [https://www.arduino.cc/en/software](https://www.arduino.cc/en/software)

---

#### 2. Add ESP32 Support

1. Open IDE > Tools > Board Manager
2. Search for esp32 > Install "esp32 by Espressif Systems"
---

#### 3. Select Board and Port

1. `Tools > Board`: choose DOIT ESP32 DEVKIT V1 or Arduino Uno R4 WiFi
2. `Tools > Port`: choose correct COM port

---

#### 4. Required Libraries

Install:

- `DHT sensor library` by Adafruit
- `Adafruit Unified Sensor`
- `WiFi.h`
- `PubSubClient`
- `ArduinoMqttClient` by Arduino
- `NTPClient` by Fabrice Weinberg

---
#### 5. arduino_secrets.h 
1. Open file `arduino_secrets.h`
    - Updated existing SSID with yours.
    - Updated existing PASS with yours.
---
#### 6. Upload Sketch

1. Open `.ino` file for the board
2. Fill in MQTT broker info and topics
3. Press Upload

### Environment Variables

#### Windows (CMD / PowerShell)

```cmd
set RMS_FIREBASE_URL=https://project-name.firebaseio.com
set GOOGLE_CLIENT_ID=google-client-id.apps.googleusercontent.com
set GOOGLE_CLIENT_SECRET=google-client-secret
set REDIRECT_URI=http://localhost:8080/api/v1/auth/google/callback
set AUTHORIZATION-URI=https://accounts.google.com/o/oauth2/v2/auth
set TOKEN_URI=https://oauth2.googleapis.com/token
set USER_INFO_URI=https://openidconnect.googleapis.com/v1/userinfo
set JWT_SECRET=secret-jwt-token
set RMS_MAIL_USERNAME=email_address@email.com
set RMS_MAIL_PASSWORD=email_password
set TWILIO_SSID=twilio-account-sid
set TWILIO_AUTH_TOKEN=twilio-auth-token
set TWILIO_PHONE_NUMBER=+40number-twilio
set ENCRYPTION_KEY=key
```

### Linux/MacOS
```cmd
export RMS_FIREBASE_URL=https://project-name.firebaseio.com
export GOOGLE_CLIENT_ID=google-client-id.apps.googleusercontent.com
export GOOGLE_CLIENT_SECRET=google-client-secret
export REDIRECT_URI=http://localhost:8080/api/v1/auth/google/callback
export AUTHORIZATION-URI=https://accounts.google.com/o/oauth2/v2/auth
export TOKEN_URI=https://oauth2.googleapis.com/token
export USER_INFO_URI=https://openidconnect.googleapis.com/v1/userinfo
export JWT_SECRET=secret-jwt-token
export RMS_MAIL_USERNAME=email_address@email.com
export RMS_MAIL_PASSWORD=email_password
export TWILIO_SSID=twilio-account-sid
export TWILIO_AUTH_TOKEN=twilio-auth-token
export TWILIO_PHONE_NUMBER=+40number-twilio
export ENCRYPTION_KEY=key
```
- Replace example values with actual project credentials.






    
